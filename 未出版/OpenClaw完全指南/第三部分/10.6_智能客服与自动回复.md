---
section_id: 10.6
title: 智能客服与自动回复
status: draft
target_words: 1500
word_count: 1650
---

# 智能客服与自动回复

客户服务是企业与客户建立长期关系的重要环节，但传统的人工客服面临成本高、响应慢、服务时间受限等问题。OpenClaw 可以帮助我们构建一个智能客服助手，实现常见问题自动回复、复杂问题智能分配、服务质量自动评估等功能，在降低成本的同时提升客户满意度。

## 场景介绍

### 客户服务的挑战

1. **重复性问题多**：大量咨询是常见问题，消耗人工资源
2. **响应时间要求高**：客户期望即时响应，人工难以满足
3. **服务时间受限**：人工客服无法提供7x24小时服务
4. **服务质量难保证**：不同客服人员的回答质量参差不齐
5. **知识更新滞后**：产品更新后，客服知识库难以及时同步

### OpenClaw 的解决方案

- **智能问答**：基于知识库自动回答常见问题
- **意图识别**：准确理解客户问题，匹配合适的解决方案
- **智能路由**：将复杂问题分配给最合适的客服人员
- **多轮对话**：支持上下文理解，处理复杂咨询
- **质量监控**：自动评估服务质量，持续优化

## 实现思路

智能客服系统的核心组件包括：

1. **意图识别器**：理解客户问题的真实意图
2. **知识库检索器**：从知识库中检索相关信息
3. **回复生成器**：生成自然、准确的回复
4. **对话管理器**：维护对话上下文
5. **人工接管器**：在必要时转接人工客服

## 配置步骤

### 第一步：创建客服 Skill

```yaml
# ~/.openclaw/skills/customer-service/SKILL.md
---
name: customer-service-assistant
description: 智能客服助手
commands:
  - name: search-knowledge-base
    description: 搜索知识库
    script: |
      # 向量化查询并检索相关知识
      curl -s -X POST "{{vector_db_url}}/search" \
        -H "Content-Type: application/json" \
        -d '{
          "query": "{{query}}",
          "collection": "knowledge_base",
          "top_k": 5,
          "filter": {"category": "{{category}}"}
        }' | jq '.results | map({content: .content, score: .score, source: .metadata.source})'

  - name: classify-intent
    description: 分类客户意图
    script: |
      python3 -c "
import json

# 简单的意图分类逻辑
query = '{{query}}'.lower()
intents = {
    'refund': ['退款', '退货', '退钱', 'cancel order'],
    'shipping': ['物流', '快递', '发货', 'delivery', 'shipping'],
    'product_info': ['价格', '规格', '功能', 'price', 'spec'],
    'technical': ['bug', 'error', '问题', '故障', '无法使用'],
    'account': ['登录', '密码', '账号', 'login', 'password']
}

for intent, keywords in intents.items():
    if any(kw in query for kw in keywords):
        print(json.dumps({'intent': intent, 'confidence': 0.85}))
        exit()

print(json.dumps({'intent': 'general', 'confidence': 0.5}))
"

  - name: create-ticket
    description: 创建工单
    script: |
      curl -s -X POST "{{ticketing_api_url}}/tickets" \
        -H "Authorization: Bearer {{secrets.ticketing_token}}" \
        -H "Content-Type: application/json" \
        -d '{
          "subject": "{{subject}}",
          "description": "{{description}}",
          "customer_email": "{{customer_email}}",
          "priority": "{{priority}}",
          "category": "{{category}}",
          "tags": {{tags | to_json}}
        }' | jq '{id: .id, status: .status}'

  - name: send-message
    description: 发送消息
    script: |
      curl -s -X POST "{{channel_api_url}}/messages" \
        -H "Authorization: Bearer {{secrets.channel_token}}" \
        -H "Content-Type: application/json" \
        -d '{
          "conversation_id": "{{conversation_id}}",
          "content": "{{content}}",
          "type": "{{message_type}}",
          "metadata": {{metadata | to_json}}
        }'

  - name: escalate-to-human
    description: 转接人工
    script: |
      curl -s -X POST "{{routing_api_url}}/escalate" \
        -H "Authorization: Bearer {{secrets.routing_token}}" \
        -H "Content-Type: application/json" \
        -d '{
          "conversation_id": "{{conversation_id}}",
          "reason": "{{escalation_reason}}",
          "priority": "{{priority}}",
          "context": {{conversation_history | to_json}}
        }'
```

### 第二步：创建客服 Agent

```yaml
# ~/.openclaw/agents/customer-service.yaml
name: customer-service
description: 客服对话专家
system_prompt: |
  你是一位专业的客户服务代表，擅长解答客户问题并提供优质服务。

  服务原则：
  1. 礼貌友好，使用恰当的称呼
  2. 回答准确，基于事实和知识库
  3. 简洁明了，避免冗长
  4. 主动提供额外帮助
  5. 不确定时诚实告知，不编造信息

  回复策略：
  - 常见问题：直接给出答案
  - 复杂问题：分步骤解释
  - 情绪问题：先安抚情绪，再解决问题
  - 技术问题：提供详细的操作指引

  转人工标准：
  - 客户明确要求人工
  - 涉及退款/投诉等敏感问题
  - 连续3次无法理解客户意图
  - 客户情绪极度不满

  输出格式（JSON）：
  {
    "response": "回复内容",
    "requires_escalation": false,
    "escalation_reason": "",
    "suggested_actions": ["建议操作1"],
    "confidence": 0.9
  }
```

### 第三步：编写客服工作流

```yaml
# ~/.openclaw/workflows/customer-service.lobster
name: customer-service
version: "1.0"

triggers:
  - type: webhook
    path: "/customer-service/incoming"

steps:
  # 1. 识别客户意图
  - name: classify_intent
    skill: customer-service-assistant
    command: classify-intent
    args:
      query: "{{input.message}}"

  # 2. 检索知识库
  - name: search_knowledge
    skill: customer-service-assistant
    command: search-knowledge-base
    args:
      query: "{{input.message}}"
      category: "{{steps.classify_intent.output.intent}}"

  # 3. 获取对话上下文
  - name: get_context
    skill: database
    command: query
    args:
      sql: |
        SELECT * FROM conversations
        WHERE conversation_id = '{{input.conversation_id}}'
        ORDER BY timestamp DESC
        LIMIT 10

  # 4. 生成回复
  - name: generate_response
    agent: customer-service
    prompt: |
      请为客户生成回复：

      客户消息：{{input.message}}
      客户意图：{{steps.classify_intent.output.intent}}
      相关知识：{{steps.search_knowledge.output}}
      对话历史：{{steps.get_context.output}}
      客户信息：{{input.customer_profile}}

      请生成合适的回复。

  # 5. 判断是否需要转人工
  - name: check_escalation
    agent: customer-service
    condition: "{{steps.generate_response.output.requires_escalation}}"
    prompt: |
      评估是否需要转接人工客服：
      客户情绪：{{input.sentiment}}
      问题复杂度：{{steps.classify_intent.output.complexity}}
      历史交互：{{steps.get_context.output}}

      判断标准：
      - 客户明确要求人工
      - 涉及敏感操作（退款、投诉）
      - 连续无法解决问题
      - 客户情绪负面

  # 6. 转接人工（如需要）
  - name: escalate
    skill: customer-service-assistant
    command: escalate-to-human
    condition: "{{steps.check_escalation.output.should_escalate}}"
    args:
      conversation_id: "{{input.conversation_id}}"
      escalation_reason: "{{steps.check_escalation.output.reason}}"
      priority: "{{steps.check_escalation.output.priority}}"
      conversation_history: "{{steps.get_context.output}}"

  # 7. 发送自动回复
  - name: send_response
    skill: customer-service-assistant
    command: send-message
    condition: "{{not steps.check_escalation.output.should_escalate}}"
    args:
      conversation_id: "{{input.conversation_id}}"
      content: "{{steps.generate_response.output.response}}"
      message_type: "text"
      metadata:
        intent: "{{steps.classify_intent.output.intent}}"
        confidence: "{{steps.generate_response.output.confidence}}"

  # 8. 记录对话
  - name: log_conversation
    skill: database
    command: insert
    args:
      table: "conversations"
      data:
        conversation_id: "{{input.conversation_id}}"
        customer_id: "{{input.customer_id}}"
        message: "{{input.message}}"
        response: "{{steps.generate_response.output.response}}"
        intent: "{{steps.classify_intent.output.intent}}"
        escalated: "{{steps.check_escalation.output.should_escalate}}"
        timestamp: "{{now}}"

  # 9. 创建工单（如需要）
  - name: create_ticket
    skill: customer-service-assistant
    command: create-ticket
    condition: "{{steps.classify_intent.output.intent in ['refund', 'technical', 'complaint']}}"
    args:
      subject: "{{input.message | truncate: 50}}"
      description: "{{input.message}}"
      customer_email: "{{input.customer_email}}"
      priority: "{{steps.check_escalation.output.priority}}"
      category: "{{steps.classify_intent.output.intent}}"
      tags:
        - "auto-generated"
        - "{{steps.classify_intent.output.intent}}"
```

### 第四步：配置客服策略

```yaml
# ~/.openclaw/config.yaml
customer_service:
  channels:
    - type: "web_chat"
      enabled: true
    - type: "email"
      enabled: true
    - type: "wechat"
      enabled: true

  business_hours:
    timezone: "Asia/Shanghai"
    weekdays: "09:00-18:00"
    weekend: "10:00-17:00"

  auto_reply:
    enabled: true
    max_response_time: "30s"
    confidence_threshold: 0.7

  escalation_rules:
    - condition: "customer_explicitly_requests"
      action: "escalate_immediately"
    - condition: "sentiment_score < -0.5"
      action: "escalate_with_priority"
    - condition: "intent == 'complaint'"
      action: "escalate_to_manager"
    - condition: "consecutive_failures >= 3"
      action: "escalate_to_human"

  knowledge_base:
    update_interval: "24h"
    sources:
      - type: "faq"
        url: "https://docs.company.com/faq"
      - type: "product_docs"
        url: "https://docs.company.com/products"
      - type: "troubleshooting"
        url: "https://docs.company.com/troubleshooting"

  quality_metrics:
    track_response_time: true
    track_satisfaction: true
    track_resolution_rate: true
```

## 实际案例

### 案例一：电商客服自动化

电商平台使用 OpenClaw 处理客户咨询：

```yaml
# 客户咨询场景
input:
  conversation_id: "conv_12345"
  customer_id: "cust_67890"
  message: "我昨天下的订单什么时候能到？订单号是20240115001"
  channel: "web_chat"

# 工作流执行结果
steps:
  classify_intent:
    output:
      intent: "shipping_inquiry"
      confidence: 0.95

  search_knowledge:
    output:
      - content: "标准快递3-5个工作日，顺丰1-2个工作日"
        source: "shipping_policy"
      - content: "订单查询方式：登录账户-我的订单-查看物流"
        source: "help_center"

  generate_response:
    output: |
      回复内容：
      "您好！感谢您的咨询。

      关于订单20240115001的配送情况：
      - 您的订单已于昨日发货
      - 使用顺丰快递，预计1-2个工作日送达
      - 您可以通过以下链接实时追踪物流：[追踪链接]

      如有其他问题，请随时联系我们！"

      requires_escalation: false
      confidence: 0.92
```

### 案例二：技术支持自动化

SaaS 公司使用 OpenClaw 处理技术支持请求：

```yaml
name: tech-support-automation

triggers:
  - type: webhook
    path: "/support/ticket-created"

steps:
  - name: analyze_ticket
    agent: tech-support
    prompt: |
      分析以下技术支持工单：
      标题：{{input.ticket.subject}}
      描述：{{input.ticket.description}}
      客户等级：{{input.customer.tier}}

      请：
      1. 分类问题类型
      2. 评估紧急程度
      3. 检索相关解决方案

  - name: search_solutions
    skill: customer-service-assistant
    command: search-knowledge-base
    args:
      query: "{{input.ticket.description}}"
      category: "technical"

  - name: generate_solution
    agent: tech-support
    prompt: |
      基于以下信息生成解决方案：
      问题：{{input.ticket.description}}
      相关知识：{{steps.search_solutions.output}}
      类似案例：{{support.case_history}}

      请提供：
      1. 问题诊断步骤
      2. 解决方案
      3. 预防措施

  - name: auto_reply_if_confident
    skill: customer-service-assistant
    command: send-message
    condition: "{{steps.generate_solution.output.confidence > 0.8}}"
    args:
      ticket_id: "{{input.ticket.id}}"
      content: "{{steps.generate_solution.output.solution}}"

  - name: assign_to_engineer
    skill: customer-service-assistant
    command: create-ticket
    condition: "{{steps.generate_solution.output.confidence <= 0.8}}"
    args:
      subject: "[L{{steps.analyze_ticket.output.level}}] {{input.ticket.subject}}"
      assignee: "{{steps.analyze_ticket.output.suggested_engineer}}"
      priority: "{{steps.analyze_ticket.output.priority}}"
```

### 案例三：社交媒体自动回复

品牌使用 OpenClaw 管理社交媒体互动：

```yaml
name: social-media-auto-response

triggers:
  - type: webhook
    path: "/social/mention"

steps:
  - name: analyze_sentiment
    agent: sentiment-analyzer
    prompt: |
      分析以下社交媒体内容的情感倾向：
      平台：{{input.platform}}
      内容：{{input.content}}
      作者：{{input.author}}

      请评估：
      1. 情感极性（正面/负面/中性）
      2. 情感强度
      3. 是否需要人工介入

  - name: classify_mention_type
    agent: customer-service
    prompt: |
      分类以下提及的类型：
      {{input.content}}

      类型：
      - 产品咨询
      - 投诉反馈
      - 正面评价
      - 负面评价
      - 无关提及

  - name: generate_social_response
    agent: customer-service
    condition: "{{steps.analyze_sentiment.output.requires_response}}"
    prompt: |
      为以下社交媒体提及生成回复：
      平台：{{input.platform}}
      内容：{{input.content}}
      情感：{{steps.analyze_sentiment.output}}
      类型：{{steps.classify_mention_type.output}}

      要求：
      1. 符合平台调性
      2. 体现品牌个性
      3. 适当使用表情符号
      4. 控制字数

  - name: post_response
    skill: social-media
    command: post-reply
    condition: "{{steps.generate_social_response.output.approved}}"
    args:
      platform: "{{input.platform}}"
      post_id: "{{input.post_id}}"
      content: "{{steps.generate_social_response.output.response}}"

  - name: escalate_if_negative
    skill: notification
    command: send
    condition: "{{steps.analyze_sentiment.output.sentiment == 'negative' and steps.analyze_sentiment.output.intensity > 0.7}}"
    args:
      channel: "slack"
      recipient: "#social-media-alerts"
      title: "负面社交媒体提及"
      content: |
        平台：{{input.platform}}
        内容：{{input.content}}
        建议：立即人工介入
```

## 进阶技巧

### 多语言支持

```yaml
- name: detect_language
  skill: customer-service-assistant
  command: detect-language
  args:
    text: "{{input.message}}"

- name: translate_if_needed
  skill: translation
  command: translate
  condition: "{{steps.detect_language.output.language != 'zh'}}"
  args:
    text: "{{input.message}}"
    target_lang: "zh"

- name: generate_multilingual_response
  agent: customer-service
  prompt: |
    生成{{steps.detect_language.output.language}}语言的回复：
    {{translated_context}}
```

### 客户画像集成

```yaml
- name: fetch_customer_profile
  skill: crm
  command: get-customer
  args:
    customer_id: "{{input.customer_id}}"

- name: personalize_response
  agent: customer-service
  prompt: |
    基于客户画像生成个性化回复：
    客户等级：{{steps.fetch_customer_profile.output.tier}}
    历史订单：{{steps.fetch_customer_profile.output.order_history}}
    过往咨询：{{steps.fetch_customer_profile.output.support_history}}
    偏好：{{steps.fetch_customer_profile.output.preferences}}

    请调整回复语气和内容。
```

通过这些配置，OpenClaw 可以成为你的智能客服助手，帮助企业提供7x24小时的优质客户服务。
