---
section_id: 7.1
title: åˆ›å»ºç¬¬ä¸€ä¸ªLobsterå·¥ä½œæµ
status: draft
target_words: 2000
word_count: 1800
---

# åˆ›å»ºç¬¬ä¸€ä¸ªLobsterå·¥ä½œæµ

åœ¨ç¬¬ä¸€éƒ¨åˆ†æˆ‘ä»¬ä»‹ç»äº†Lobsterå¼•æ“çš„æ¦‚å¿µã€‚ç°åœ¨è®©æˆ‘ä»¬åŠ¨æ‰‹åˆ›å»ºä¸€ä¸ªå®é™…çš„å·¥ä½œæµã€‚

## å·¥ä½œæµæ–‡ä»¶ä½ç½®

Lobsterå·¥ä½œæµå­˜æ”¾åœ¨ï¼š

```
~/.openclaw/workspace/lobster/
â”œâ”€â”€ daily-news.yaml        # æ¯æ—¥æ–°é—»
â”œâ”€â”€ weekly-report.yaml     # å‘¨æŠ¥ç”Ÿæˆ
â”œâ”€â”€ email-cleanup.yaml     # é‚®ä»¶æ¸…ç†
â””â”€â”€ ...
```

## åˆ›å»ºç®€å•å·¥ä½œæµ

### ç¤ºä¾‹ï¼šæ¯æ—¥æ–°é—»ç®€æŠ¥

```yaml
# ~/.openclaw/workspace/lobster/daily-news.yaml

name: daily-news-briefing

# è¾“å…¥å‚æ•°
args:
  news_url: "https://news.ycombinator.com"
  output_path: "~/Documents/daily-news"

# æ‰§è¡Œæ­¥éª¤
steps:
  # æ­¥éª¤1ï¼šè·å–ç½‘é¡µå†…å®¹
  - name: fetch-news
    tool: shell
    args: ["curl", "-s", "{{news_url}}"]

  # æ­¥éª¤2ï¼šAIæå–å’Œæ€»ç»“
  - name: summarize
    tool: python
    script: |
      import json
      import os

      # è·å–ä¸Šä¸€æ­¥çš„è¾“å‡º
      html_content = """{{fetch-news.output}}"""

      # ä½¿ç”¨AIæ¨¡å‹å¤„ç†ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡è°ƒç”¨ï¼‰
      # è¿™é‡Œè°ƒç”¨OpenClawçš„Agentè¿›è¡ŒAIå¤„ç†
      result = os.popen(f'''
        openclaw agent ask "ä»ä»¥ä¸‹å†…å®¹ä¸­æå–å‰5æ¡æ–°é—»æ ‡é¢˜ï¼Œå¹¶ä¸ºæ¯æ¡ç”Ÿæˆ50å­—æ‘˜è¦ï¼š

        {html_content[:5000]}

        è¾“å‡ºæ ¼å¼ï¼š
        1. [æ ‡é¢˜] - æ‘˜è¦
        2. ..."
      ''').read()

      print(result)

  # æ­¥éª¤3ï¼šä¿å­˜åˆ°æ–‡ä»¶
  - name: save
    tool: shell
    args: ["bash", "-c", "echo '{{summarize.output}}' > {{output_path}}/{{date}}.md"]
```

### è¿è¡Œå·¥ä½œæµ

```bash
openclaw lobster run daily-news
```

è¾“å‡ºï¼š
```
ğŸ¦ Running workflow: daily-news-briefing

Step 1/3: fetch-news
  Tool: shell
  Status: âœ“ å®Œæˆ (2.3s)

Step 2/3: summarize
  Tool: python
  Status: âœ“ å®Œæˆ (4.1s)

Step 3/3: save
  Tool: shell
  Status: âœ“ å®Œæˆ (0.1s)

âœ… Workflow completed in 6.5s
   Output: ~/Documents/daily-news/2024-01-15.md
```

## å·¥ä½œæµè¯­æ³•è¯¦è§£

### åŸºæœ¬ç»“æ„

```yaml
name: workflow-name        # å·¥ä½œæµåç§°ï¼ˆå¿…éœ€ï¼‰

args:                      # è¾“å…¥å‚æ•°ï¼ˆå¯é€‰ï¼‰
  param1: default-value

steps:                     # æ‰§è¡Œæ­¥éª¤ï¼ˆå¿…éœ€ï¼‰
  - name: step-name
    tool: tool-name
    # ... å…¶ä»–é…ç½®
```

### æ”¯æŒçš„å·¥å…·

| å·¥å…· | è¯´æ˜ | ç¤ºä¾‹ |
|-----|------|------|
| `shell` | æ‰§è¡ŒShellå‘½ä»¤ | `args: ["ls", "-la"]` |
| `python` | æ‰§è¡ŒPythonè„šæœ¬ | `script: "print('hello')"` |

### æ­¥éª¤å­—æ®µ

| å­—æ®µ | è¯´æ˜ | å¿…éœ€ |
|-----|------|------|
| `name` | æ­¥éª¤åç§°ï¼ˆç”¨äºå¼•ç”¨è¾“å‡ºï¼‰ | æ˜¯ |
| `tool` | ä½¿ç”¨çš„å·¥å…·ï¼ˆshell/pythonï¼‰ | æ˜¯ |
| `args` | Shellå‘½ä»¤å‚æ•°ï¼ˆtool: shellæ—¶ï¼‰ | éƒ¨åˆ† |
| `script` | Pythonè„šæœ¬ï¼ˆtool: pythonæ—¶ï¼‰ | éƒ¨åˆ† |
| `approval` | æ˜¯å¦éœ€è¦å®¡æ‰¹ | å¦ |
| `condition` | æ‰§è¡Œæ¡ä»¶ | å¦ |
| `retry` | é‡è¯•é…ç½® | å¦ |

### æ¨¡æ¿å˜é‡

ä½¿ç”¨ `{{}}` è¯­æ³•å¼•ç”¨å˜é‡ï¼š

```yaml
# å¼•ç”¨è¾“å…¥å‚æ•°
url: "{{news_url}}"

# å¼•ç”¨å…¶ä»–æ­¥éª¤çš„è¾“å‡º
content: "{{fetch-news.output}}"

# å†…ç½®å˜é‡
path: "{{output_path}}/{{date}}.md"      # æ—¥æœŸ
path: "{{output_path}}/{{timestamp}}.md" # æ—¶é—´æˆ³
path: "~/{{env.HOME}}/Documents"         # ç¯å¢ƒå˜é‡
```

## æ›´å¤šç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæ–‡ä»¶å¤‡ä»½

```yaml
name: backup-documents

args:
  source: "~/Documents"
  backup: "~/Backups"

steps:
  - name: list-files
    tool: shell
    args: ["find", "{{source}}", "-type", "f", "-mtime", "-1"]

  - name: create-backup-dir
    tool: shell
    args: ["mkdir", "-p", "{{backup}}/{{date}}"]

  - name: copy-files
    tool: shell
    args: ["cp", "-r", "{{source}}", "{{backup}}/{{date}}/"]

  - name: report
    tool: python
    script: |
      import os

      source = "{{source}}"
      backup_path = "{{backup}}/{{date}}"
      file_list = """{{list-files.output}}"""

      print(f"å¤‡ä»½æŠ¥å‘Šï¼š")
      print(f"- æºç›®å½•ï¼š{source}")
      print(f"- å¤‡ä»½ä½ç½®ï¼š{backup_path}")
      print(f"- æ–‡ä»¶æ•°é‡ï¼š{len(file_list.strip().split(chr(10)))}")
```

### ç¤ºä¾‹2ï¼šé‚®ä»¶æ•´ç†

```yaml
name: email-cleanup

args:
  action: "archive-read-older-than-30-days"

steps:
  # ä½¿ç”¨Pythonè„šæœ¬è°ƒç”¨é‚®ä»¶API
  - name: list-emails
    tool: python
    script: |
      import subprocess
      import json

      # è°ƒç”¨é‚®ä»¶æŠ€èƒ½æŸ¥è¯¢é‚®ä»¶
      result = subprocess.run(
        ["openclaw", "skill", "email", "search", "is:read older_than:30d"],
        capture_output=True, text=True
      )
      print(result.stdout)

  # AIåˆ†ç±»å¤„ç†
  - name: categorize
    tool: python
    script: |
      import os

      emails = """{{list-emails.output}}"""

      # è°ƒç”¨AIè¿›è¡Œåˆ†ç±»
      prompt = f'''
      å°†è¿™äº›é‚®ä»¶åˆ†ç±»ï¼š
      {emails}

      è¿”å›JSONæ ¼å¼ï¼š
      {{
        "archive": [...],
        "delete": [...],
        "keep": [...]
      }}
      '''

      result = os.popen(f'openclaw agent ask "{prompt}"').read()
      print(result)

  # æ‰§è¡Œå½’æ¡£æ“ä½œï¼ˆéœ€è¦å®¡æ‰¹ï¼‰
  - name: archive-emails
    tool: shell
    args: ["echo", "å½’æ¡£æ“ä½œéœ€è¦æ‰‹åŠ¨ç¡®è®¤åæ‰§è¡Œ"]
    approval: required

  # ç”Ÿæˆæ‘˜è¦
  - name: summary
    tool: python
    script: |
      import json

      # è§£æåˆ†ç±»ç»“æœ
      categorize_result = """{{categorize.output}}"""

      # ç®€å•ç»Ÿè®¡ï¼ˆå®é™…åº”è§£æJSONï¼‰
      lines = categorize_result.split('\n')
      print("æ•´ç†æ‘˜è¦ï¼š")
      print(f"- å·²å¤„ç†é‚®ä»¶æ•°é‡ï¼š{len(lines)}")
      print("- è¯·æŸ¥çœ‹è¯¦ç»†åˆ†ç±»ç»“æœ")
```

### ç¤ºä¾‹3ï¼šGitHub IssueåŒæ­¥

```yaml
name: sync-github-issues

args:
  repo: "myorg/myapp"
  project: "My Project"

steps:
  - name: fetch-issues
    tool: shell
    args: ["gh", "issue", "list", "--repo", "{{repo}}", "--state", "open", "--json", "number,title"]

  - name: fetch-project-items
    tool: shell
    args: ["gh", "project", "item-list", "{{project}}", "--format", "json"]

  - name: find-missing
    tool: python
    script: |
      import json

      issues = """{{fetch-issues.output}}"""
      project_items = """{{fetch-project-items.output}}"""

      # è§£æå¹¶æ¯”è¾ƒ
      try:
        issue_list = json.loads(issues)
        project_list = json.loads(project_items)

        issue_numbers = {str(i['number']) for i in issue_list}
        project_numbers = {str(p['content']['number']) for p in project_list if 'number' in p.get('content', {})}

        missing = issue_numbers - project_numbers
        print(json.dumps(list(missing)))
      except:
        print("[]")

  - name: add-to-project
    tool: shell
    args: ["echo", "éœ€è¦å°†ä»¥ä¸‹Issueæ·»åŠ åˆ°é¡¹ç›®ï¼š{{find-missing.output}}"]
    approval: required
```

## æ¡ä»¶æ‰§è¡Œ

### æ¡ä»¶åˆ¤æ–­

```yaml
steps:
  - name: check-condition
    tool: shell
    args: ["test", "-f", "{{file_path}}"]

  - name: process-if-exists
    tool: shell
    args: ["cat", "{{file_path}}"]
    condition: "{{check-condition.success}}"

  - name: create-if-not-exists
    tool: shell
    args: ["bash", "-c", "echo 'New file' > {{file_path}}"]
    condition: "{{not check-condition.success}}"
```

### å¾ªç¯å¤„ç†

```yaml
steps:
  - name: list-items
    tool: shell
    args: ["ls", "{{directory}}"]

  # ä½¿ç”¨Pythonå®ç°å¾ªç¯å¤„ç†
  - name: process-each
    tool: python
    script: |
      import os

      items = """{{list-items.output}}"""
      directory = "{{directory}}"

      for item in items.strip().split('\n'):
        item_path = os.path.join(directory, item)
        if os.path.isfile(item_path):
          # å¤„ç†æ¯ä¸ªæ–‡ä»¶
          with open(item_path, 'r') as f:
            content = f.read()
          print(f"å¤„ç†æ–‡ä»¶ï¼š{item}ï¼Œå¤§å°ï¼š{len(content)} å­—èŠ‚")
```

## é”™è¯¯å¤„ç†

### é‡è¯•é…ç½®

```yaml
steps:
  - name: api-call
    tool: shell
    args: ["curl", "-s", "https://api.example.com/data"]
    retry:
      maxAttempts: 3
      delay: 5s
      backoff: exponential
```

### é”™è¯¯å›é€€

```yaml
steps:
  - name: primary-action
    tool: shell
    args: ["curl", "-s", "https://primary-api.com/data"]
    fallback:
      tool: shell
      args: ["curl", "-s", "https://backup-api.com/data"]
```

### è·³è¿‡å¤±è´¥

```yaml
steps:
  - name: optional-step
    tool: shell
    args: ["some-command"]
    continueOnError: true
```

## è°ƒåº¦æ‰§è¡Œ

### Croné…ç½®

åœ¨ `openclaw.json` ä¸­é…ç½®å®šæ—¶æ‰§è¡Œï¼š

```json
{
  "crons": {
    "daily-news": {
      "schedule": "0 8 * * *",
      "workflow": "daily-news-briefing"
    },
    "weekly-report": {
      "schedule": "0 9 * * 1",
      "workflow": "weekly-report"
    }
  }
}
```

### ç®¡ç†å®šæ—¶ä»»åŠ¡

```bash
# åˆ—å‡ºæ‰€æœ‰å®šæ—¶ä»»åŠ¡
openclaw cron list

# å¯ç”¨/ç¦ç”¨
openclaw cron enable daily-news
openclaw cron disable daily-news

# æ‰‹åŠ¨è§¦å‘
openclaw cron trigger daily-news
```

## å·¥ä½œæµç®¡ç†å‘½ä»¤

```bash
# åˆ—å‡ºæ‰€æœ‰å·¥ä½œæµ
openclaw lobster list

# æŸ¥çœ‹å·¥ä½œæµè¯¦æƒ…
openclaw lobster show daily-news

# è¿è¡Œå·¥ä½œæµ
openclaw lobster run daily-news

# éªŒè¯å·¥ä½œæµè¯­æ³•
openclaw lobster validate daily-news

# æŸ¥çœ‹æ‰§è¡Œå†å²
openclaw lobster history daily-news

# æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—
openclaw lobster logs daily-news --last
```

---

**æœ¬èŠ‚å°ç»“**

- å·¥ä½œæµå­˜æ”¾åœ¨ `~/.openclaw/workspace/lobster/`
- ä½¿ç”¨YAMLå®šä¹‰å·¥ä½œæµï¼ŒåŒ…å«argså’Œsteps
- åªæ”¯æŒ `tool: shell` å’Œ `tool: python` ä¸¤ç§å·¥å…·
- æ­¥éª¤é—´é€šè¿‡ `{{step-name.output}}` ä¼ é€’æ•°æ®
- ä½¿ç”¨ `args` å®šä¹‰shellå‘½ä»¤å‚æ•°ï¼Œä½¿ç”¨ `script` å®šä¹‰Pythonä»£ç 
- æ”¯æŒæ¡ä»¶æ‰§è¡Œã€é”™è¯¯å¤„ç†
- é€šè¿‡croné…ç½®å®šæ—¶æ‰§è¡Œ
- ä½¿ç”¨ `openclaw lobster` å‘½ä»¤ç®¡ç†å·¥ä½œæµ
