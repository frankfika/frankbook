---
section_id: 7.4
title: å·¥ä½œæµè°ƒè¯•æŠ€å·§
status: draft
target_words: 2000
word_count: 1700
---

# å·¥ä½œæµè°ƒè¯•æŠ€å·§

å·¥ä½œæµå¼€å‘è¿‡ç¨‹ä¸­éš¾å…é‡åˆ°é—®é¢˜ã€‚æŒæ¡è°ƒè¯•æŠ€å·§ï¼Œèƒ½å¸®ä½ å¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜ã€‚

## å¸¸è§é—®é¢˜ç±»å‹

### 1. è¯­æ³•é”™è¯¯

```yaml
# é”™è¯¯ç¤ºä¾‹
steps:
  - name: fetch
    tool: shell
    args: ["curl", "-s", "{{news_url}}"]  # ç¼ºå°‘argså­—æ®µ
```

### 2. å˜é‡å¼•ç”¨é”™è¯¯

```yaml
# é”™è¯¯ç¤ºä¾‹
steps:
  - name: step1
    tool: shell
    args: ["echo", "hello"]

  - name: step2
    tool: python
    script: |
      # é”™è¯¯ï¼šåº”è¯¥æ˜¯ {{step1.output}} è€Œä¸æ˜¯ {{step1.result}}
      result = """{{step1.result}}"""
      print(result)
```

### 3. å·¥å…·è°ƒç”¨å¤±è´¥

```yaml
# å¯èƒ½å¤±è´¥
steps:
  - name: api-call
    tool: shell
    args: ["curl", "-s", "https://api.example.com/data"]
    # ç½‘ç»œé—®é¢˜ã€APIé™æµã€è®¤è¯å¤±è´¥ç­‰
```

### 4. AIè¾“å‡ºæ ¼å¼é”™è¯¯

```yaml
# AIè¿”å›æ ¼å¼ä¸ç¬¦åˆé¢„æœŸ
steps:
  - name: classify
    tool: python
    script: |
      import openai

      response = openai.chat.completions.create(
        model="gpt-4",
        messages=[{
          "role": "user",
          "content": 'è¿”å›JSONæ ¼å¼ï¼š{"category": "..."}'
        }]
      )

      # AIå¯èƒ½è¿”å›ï¼šThe category is work.ï¼ˆä¸æ˜¯JSONï¼‰
      print(response.choices[0].message.content)
```

## è°ƒè¯•å·¥å…·

### éªŒè¯å·¥ä½œæµè¯­æ³•

```bash
openclaw lobster validate daily-news
```

è¾“å‡ºï¼š
```
Validating daily-news.yaml...

âŒ Error at line 15:
  Missing required field 'args' for tool 'shell'

Suggestion:
  Add 'args: ["curl", "-s", "URL"]' to the step configuration
```

### å•æ­¥è°ƒè¯•

```bash
# è¿è¡Œåˆ°æŒ‡å®šæ­¥éª¤
openclaw lobster run daily-news --step fetch-news

# æŸ¥çœ‹æ­¥éª¤è¾“å‡º
openclaw lobster run daily-news --step fetch-news --verbose
```

è¾“å‡ºï¼š
```
ğŸ¦ Running step: fetch-news

Tool: shell
Args: ["curl", "-s", "https://news.ycombinator.com"]

Output:
  Status: 200
  Content-Type: text/html
  Size: 45.2KB

  Preview:
  <!DOCTYPE html>
  <html>
  ...
```

### æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—

```bash
# æŸ¥çœ‹æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œæ—¥å¿—
openclaw lobster logs daily-news --last

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
openclaw lobster logs daily-news --follow

# æŸ¥çœ‹ç‰¹å®šæ­¥éª¤çš„æ—¥å¿—
openclaw lobster logs daily-news --step summarize
```

è¾“å‡ºï¼š
```
[2024-01-15 10:30:15] Starting workflow: daily-news-briefing
[2024-01-15 10:30:15] Step 1/3: fetch-news
[2024-01-15 10:30:17] âœ“ fetch-news completed (2.1s)
[2024-01-15 10:30:17] Output size: 45.2KB
[2024-01-15 10:30:17] Step 2/3: summarize
[2024-01-15 10:30:21] âœ“ summarize completed (4.2s)
[2024-01-15 10:30:21] AI model: claude-3-5-sonnet
[2024-01-15 10:30:21] Tokens used: 1,234 input, 456 output
[2024-01-15 10:30:21] Step 3/3: save
[2024-01-15 10:30:21] âœ“ save completed (0.1s)
[2024-01-15 10:30:21] âœ… Workflow completed (6.4s)
```

## è°ƒè¯•æ¨¡å¼

### å¯ç”¨è¯¦ç»†è¾“å‡º

```bash
openclaw lobster run daily-news --verbose
```

### å¯ç”¨è°ƒè¯•æ¨¡å¼

```bash
openclaw lobster run daily-news --debug
```

è¾“å‡ºåŒ…å«ï¼š
- å˜é‡è§£æè¿‡ç¨‹
- å·¥å…·è°ƒç”¨è¯¦æƒ…
- AIè¯·æ±‚å’Œå“åº”
- æ‰§è¡Œæ—¶é—´åˆ†æ

### äº¤äº’å¼è°ƒè¯•

```bash
openclaw lobster debug daily-news
```

è¿›å…¥äº¤äº’å¼è°ƒè¯•ç•Œé¢ï¼š

```
ğŸ¦ Lobster Debugger: daily-news-briefing

Current step: fetch-news (1/3)

> show args
news_url: https://news.ycombinator.com
output_path: ~/Documents/daily-news

> run step
Executing fetch-news...
âœ“ Completed

> show output
<!DOCTYPE html>
...

> next
Moving to step: summarize (2/3)

> edit prompt
> summarize the content in 5 bullet points

> run step
Executing summarize with modified prompt...
âœ“ Completed

> continue
Executing remaining steps...
âœ… Workflow completed
```

## å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šå˜é‡æœªè§£æ

**ç—‡çŠ¶**ï¼š
```
Error: Variable 'fetch-news.output' not found
```

**åŸå› **ï¼šæ­¥éª¤åç§°é”™è¯¯æˆ–æ­¥éª¤æœªæ‰§è¡Œ

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥æ­¥éª¤åç§°
openclaw lobster show daily-news

# ç¡®ä¿æ­¥éª¤æ­£ç¡®æ‰§è¡Œ
openclaw lobster logs daily-news --step fetch-news
```

### é—®é¢˜2ï¼šAIè¿”å›æ ¼å¼é”™è¯¯

**ç—‡çŠ¶**ï¼š
```
Error: Failed to parse AI output as JSON
```

**è§£å†³**ï¼šæ”¹è¿›promptï¼Œæ˜ç¡®è¾“å‡ºæ ¼å¼

```yaml
# æ”¹è¿›å‰
- name: classify
  tool: python
  script: |
    import openai
    response = openai.chat.completions.create(
      model="gpt-4",
      messages=[{"role": "user", "content": "åˆ†ç±»è¿™äº›æ–‡ä»¶"}]
    )
    print(response.choices[0].message.content)

# æ”¹è¿›å
- name: classify
  tool: python
  script: |
    import openai

    response = openai.chat.completions.create(
      model="gpt-4",
      messages=[{
        "role": "user",
        "content": """åˆ†ç±»è¿™äº›æ–‡ä»¶ï¼Œè¿”å›ä¸¥æ ¼çš„JSONæ ¼å¼ã€‚

ç¤ºä¾‹è¾“å‡ºï¼š
{"work": ["file1.pdf"], "personal": ["file2.jpg"]}

åªè¿”å›JSONï¼Œä¸è¦å…¶ä»–è§£é‡Šã€‚"""
      }]
    )

    print(response.choices[0].message.content)
```

### é—®é¢˜3ï¼šç½‘ç»œè¶…æ—¶

**ç—‡çŠ¶**ï¼š
```
Error: Request timeout after 30s
```

**è§£å†³**ï¼šå¢åŠ è¶…æ—¶æ—¶é—´

```yaml
steps:
  - name: fetch
    tool: shell
    args: ["curl", "-s", "--max-time", "60", "https://slow-api.com/data"]
```

### é—®é¢˜4ï¼šæƒé™è¢«æ‹’ç»

**ç—‡çŠ¶**ï¼š
```
Error: Permission denied: /root/secret
```

**è§£å†³**ï¼šæ£€æŸ¥æ²™ç®±é…ç½®

```json
{
  "agents": {
    "defaults": {
      "sandbox": {
        "workspaceAccess": "rw"
      }
    }
  }
}
```

## æµ‹è¯•æŠ€å·§

### å•å…ƒæµ‹è¯•æ­¥éª¤

```bash
# æµ‹è¯•å•ä¸ªå·¥å…·
openclaw lobster test-tool shell --args '["curl", "-s", "https://example.com"]'

# æµ‹è¯•Pythonè„šæœ¬
openclaw lobster test-tool python --script 'print("Hello World")'
```

### æ¨¡æ‹Ÿæ•°æ®

```yaml
steps:
  - name: mock-fetch
    tool: shell
    args: ["cat", "mock-news.html"]

  - name: process
    tool: python
    script: |
      import openai

      content = """{{mock-fetch.output}}"""

      response = openai.chat.completions.create(
        model="gpt-4",
        messages=[{"role": "user", "content": f"Process: {content}"}]
      )

      print(response.choices[0].message.content)
```

### ç¯å¢ƒéš”ç¦»

```bash
# ä½¿ç”¨æµ‹è¯•é…ç½®
openclaw lobster run daily-news --config test-config.yaml

# ä½¿ç”¨æµ‹è¯•ç¯å¢ƒå˜é‡
openclaw lobster run daily-news --env-file .env.test
```

## æ€§èƒ½åˆ†æ

### æ‰§è¡Œæ—¶é—´åˆ†æ

```bash
openclaw lobster analyze daily-news
```

è¾“å‡ºï¼š
```
Workflow Performance Analysis: daily-news-briefing

Step              Time    % Total   Status
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
fetch-news        2.3s    35%       âœ“
summarize         4.1s    63%       âœ“
save              0.1s    2%        âœ“
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total             6.5s    100%

Bottleneck: summarize (63% of time)

Suggestion: Consider using a faster model for simple summarization
```

### Tokenä½¿ç”¨åˆ†æ

```bash
openclaw lobster tokens daily-news
```

è¾“å‡ºï¼š
```
Token Usage Analysis: daily-news-briefing

Step              Input    Output    Cost
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
summarize         1,234    456       $0.02
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total             1,234    456       $0.02

Suggestions:
- Reduce input size by truncating HTML
- Use faster model for simple tasks
```

## æ—¥å¿—é…ç½®

### æ—¥å¿—çº§åˆ«

```json
{
  "lobster": {
    "logging": {
      "level": "debug",  // debug, info, warn, error
      "file": "~/.openclaw/lobster.log"
    }
  }
}
```

### æ—¥å¿—æ ¼å¼

```bash
# æŸ¥çœ‹JSONæ ¼å¼æ—¥å¿—
openclaw lobster logs daily-news --format json

# å¯¼å‡ºæ—¥å¿—
openclaw lobster logs daily-news --export lobster-debug.log
```

---

**æœ¬èŠ‚å°ç»“**

- ä½¿ç”¨ `validate` æ£€æŸ¥è¯­æ³•é”™è¯¯
- ä½¿ç”¨ `--verbose` å’Œ `--debug` è·å–è¯¦ç»†ä¿¡æ¯
- ä½¿ç”¨ `lobster debug` è¿›å…¥äº¤äº’å¼è°ƒè¯•
- æ”¹è¿›AI promptç¡®ä¿è¾“å‡ºæ ¼å¼æ­£ç¡®
- ä½¿ç”¨mockæ•°æ®éš”ç¦»æµ‹è¯•
- ä½¿ç”¨ `analyze` å’Œ `tokens` åˆ†ææ€§èƒ½
- é…ç½®æ—¥å¿—çº§åˆ«è·å–è¯¦ç»†æ—¥å¿—
