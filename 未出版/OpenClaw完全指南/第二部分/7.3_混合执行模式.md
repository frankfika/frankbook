---
section_id: 7.3
title: æ··åˆæ‰§è¡Œæ¨¡å¼
status: draft
target_words: 1500
word_count: 1300
---

# æ··åˆæ‰§è¡Œæ¨¡å¼

Lobsterçš„æ ¸å¿ƒä¼˜åŠ¿æ˜¯æ”¯æŒ**ç¡¬ç¼–ç å·¥å…·**å’Œ**AIæ¨ç†**çš„æ··åˆæ‰§è¡Œã€‚

## ä¸¤ç§æ‰§è¡Œæ¨¡å¼

### ç¡¬ç¼–ç å·¥å…·

```yaml
steps:
  - name: list-files
    tool: shell
    args: ["ls", "-la", "~/Documents"]
```

ç‰¹ç‚¹ï¼š
- ç¡®å®šæ€§ï¼šæ¯æ¬¡æ‰§è¡Œç»“æœç›¸åŒ
- å¿«é€Ÿï¼šæ— LLMè°ƒç”¨å»¶è¿Ÿ
- å¯é ï¼šä¸ä¼šäº§ç”Ÿå¹»è§‰
- å±€é™ï¼šåªèƒ½åšé¢„å®šä¹‰çš„æ“ä½œ

### AIæ¨ç†

```yaml
steps:
  - name: summarize
    tool: python
    script: |
      import openai

      content = """{{input}}"""

      response = openai.chat.completions.create(
        model="gpt-4",
        messages=[{"role": "user", "content": f"æ€»ç»“ä»¥ä¸‹å†…å®¹ï¼š{content}"}]
      )

      print(response.choices[0].message.content)
```

ç‰¹ç‚¹ï¼š
- çµæ´»ï¼šå¤„ç†å„ç§éç»“æ„åŒ–è¾“å…¥
- æ™ºèƒ½ï¼šç†è§£è¯­ä¹‰ã€åˆ†ç±»ã€æ€»ç»“
- åˆ›é€ æ€§ï¼šç”Ÿæˆå†…å®¹
- å±€é™ï¼šå¯èƒ½å‡ºé”™ï¼Œä¸ç¡®å®š

## æ··åˆæ¨¡å¼çš„ä¼˜åŠ¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¡¬ç¼–ç å·¥å…·æ“…é•¿                                           â”‚
â”‚ - è¯»å–æ–‡ä»¶ã€ç›®å½•æ“ä½œ                                     â”‚
â”‚ - æ‰§è¡ŒShellå‘½ä»¤                                         â”‚
â”‚ - APIè°ƒç”¨ã€æ•°æ®åº“æŸ¥è¯¢                                    â”‚
â”‚ - ç²¾ç¡®çš„å­—ç¬¦ä¸²å¤„ç†                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ AIæ¨ç†æ“…é•¿                                              â”‚
â”‚ - ç†è§£è¯­ä¹‰                                              â”‚
â”‚ - åˆ†ç±»ã€æ€»ç»“                                            â”‚
â”‚ - å¤„ç†æ¨¡ç³Šè¾“å…¥                                          â”‚
â”‚ - ç”Ÿæˆå†…å®¹                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ··åˆæ¨¡å¼                                                â”‚
â”‚ ç¡¬ç¼–ç å·¥å…· â”€â”€è·å–æ•°æ®â”€â”€> AIæ¨ç† â”€â”€å¤„ç†â”€â”€> ç¡¬ç¼–ç å·¥å…· â”€â”€æ‰§è¡Œâ”€â”€> å®Œæˆ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å®æˆ˜ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæ™ºèƒ½æ–‡ä»¶æ•´ç†

```yaml
name: smart-file-organizer

args:
  source_dir: "~/Downloads"

steps:
  # æ­¥éª¤1ï¼šç¡¬ç¼–ç å·¥å…·è·å–æ–‡ä»¶åˆ—è¡¨
  - name: list-files
    tool: shell
    args: ["ls", "-la", "{{source_dir}}"]

  # æ­¥éª¤2ï¼šPythonè°ƒç”¨AIè¿›è¡Œåˆ†ç±»
  - name: classify
    tool: python
    script: |
      import json
      import openai

      files = """{{list-files.output}}"""

      response = openai.chat.completions.create(
        model="gpt-4",
        messages=[{
          "role": "user",
          "content": f"""å°†ä»¥ä¸‹æ–‡ä»¶åˆ†ç±»åˆ° work, personal, media, other å››ä¸ªç±»åˆ«ï¼š

{files}

è¿”å›JSONæ ¼å¼ï¼š
{{
  "work": ["file1.pdf", "file2.docx"],
  "personal": ["photo.jpg"],
  "media": ["video.mp4"],
  "other": ["unknown.bin"]
}}"""
        }]
      )

      print(response.choices[0].message.content)

  # æ­¥éª¤3ï¼šç¡¬ç¼–ç å·¥å…·æ‰§è¡Œç§»åŠ¨
  - name: move-files
    tool: shell
    args: |
      for file in {{classify.output.work}}; do
        mv "{{source_dir}}/$file" "~/Documents/Work/"
      done
      for file in {{classify.output.personal}}; do
        mv "{{source_dir}}/$file" "~/Documents/Personal/"
      done
```

### ç¤ºä¾‹2ï¼šæ™ºèƒ½é‚®ä»¶å¤„ç†

```yaml
name: email-triage

steps:
  # ç¡¬ç¼–ç ï¼šè·å–é‚®ä»¶åˆ—è¡¨
  - name: fetch-emails
    tool: shell
    args: ["mail", "-u", "user@company.com", "-f", "INBOX", "-s", "Subject"]

  # AIï¼šä¼˜å…ˆçº§åˆ†ç±»
  - name: prioritize
    tool: python
    script: |
      import json
      import openai

      emails = """{{fetch-emails.output}}"""

      response = openai.chat.completions.create(
        model="gpt-4",
        messages=[{
          "role": "user",
          "content": f"""åˆ†æè¿™äº›é‚®ä»¶ï¼ŒæŒ‰ä¼˜å…ˆçº§åˆ†ç±»ï¼š

{emails}

åˆ†ç±»æ ‡å‡†ï¼š
- urgent: æ¥è‡ªè€æ¿/å®¢æˆ·ï¼Œæåˆ°ç´§æ€¥/æˆªæ­¢æ—¥æœŸ
- important: å·¥ä½œç›¸å…³ï¼Œéœ€è¦å›å¤
- low: è®¢é˜…é‚®ä»¶ã€é€šçŸ¥

è¿”å›JSONï¼š
{{
  "urgent": [...],
  "important": [...],
  "low": [...]
}}"""
        }]
      )

      print(response.choices[0].message.content)

  # ç¡¬ç¼–ç ï¼šå‘é€é€šçŸ¥åˆ°Slack
  - name: notify
    tool: shell
    args: |
      curl -X POST https://slack.com/api/chat.postMessage \
        -H "Authorization: Bearer $SLACK_TOKEN" \
        -H "Content-Type: application/json" \
        -d '{
          "channel": "#notifications",
          "text": "ğŸ“¬ æ–°é‚®ä»¶æ‘˜è¦\n\n{{prioritize.output}}"
        }'
```

### ç¤ºä¾‹3ï¼šä»£ç å®¡æŸ¥

```yaml
name: code-review

args:
  repo: "myorg/myapp"
  pr_number: 123

steps:
  # ç¡¬ç¼–ç ï¼šè·å–PRå˜æ›´
  - name: get-diff
    tool: shell
    args: |
      curl -s -H "Authorization: token $GITHUB_TOKEN" \
        https://api.github.com/repos/{{repo}}/pulls/{{pr_number}}/files

  # AIï¼šå®¡æŸ¥ä»£ç 
  - name: review
    tool: python
    script: |
      import openai

      diff = """{{get-diff.output}}"""

      response = openai.chat.completions.create(
        model="gpt-4",
        messages=[{
          "role": "user",
          "content": f"""å®¡æŸ¥ä»¥ä¸‹ä»£ç å˜æ›´ï¼Œæ£€æŸ¥ï¼š
1. æ½œåœ¨çš„bug
2. æ€§èƒ½é—®é¢˜
3. å®‰å…¨æ¼æ´
4. ä»£ç é£æ ¼

ä»£ç å˜æ›´ï¼š
{diff}

è¿”å›æ ¼å¼ï¼š
- é—®é¢˜åˆ—è¡¨
- ä¸¥é‡ç¨‹åº¦
- å»ºè®®ä¿®æ”¹"""
        }]
      )

      print(response.choices[0].message.content)

  # AIï¼šç”Ÿæˆè¯„è®º
  - name: format-comment
    tool: python
    script: |
      import openai

      review_result = """{{review.output}}"""

      response = openai.chat.completions.create(
        model="gpt-4",
        messages=[{
          "role": "user",
          "content": f"""å°†ä»¥ä¸‹å®¡æŸ¥ç»“æœæ ¼å¼åŒ–ä¸ºå‹å¥½çš„PRè¯„è®ºï¼š

{review_result}

ä½¿ç”¨Markdownæ ¼å¼ï¼ŒåŒ…å«emojiã€‚"""
        }]
      )

      print(response.choices[0].message.content)

  # ç¡¬ç¼–ç ï¼šå‘å¸ƒè¯„è®º
  - name: post-comment
    tool: shell
    args: |
      curl -s -X POST \
        -H "Authorization: token $GITHUB_TOKEN" \
        -H "Content-Type: application/json" \
        https://api.github.com/repos/{{repo}}/issues/{{pr_number}}/comments \
        -d '{{"body": "{{format-comment.output}}"}}'
```

## æ··åˆæ¨¡å¼æœ€ä½³å®è·µ

### 1. ç”¨ç¡¬ç¼–ç å·¥å…·åšæ•°æ®è·å–

```yaml
# âœ“ æ­£ç¡®
- name: fetch-data
  tool: shell
  args: ["curl", "-s", "https://api.example.com/data"]

# âœ— ä¸æ¨è
- name: fetch-data
  tool: python
  script: |
    # ä¸æ¨èï¼šè®©AIé€šè¿‡APIè®¿é—®URLï¼ˆæ•ˆç‡ä½ä¸”ä¸å¯é ï¼‰
    import openai
    response = openai.chat.completions.create(
      model="gpt-4",
      messages=[{"role": "user", "content": "è®¿é—® https://api.example.com/data å¹¶å‘Šè¯‰æˆ‘ç»“æœ"}]
    )
    print(response.choices[0].message.content)
```

### 2. ç”¨AIå¤„ç†éç»“æ„åŒ–æ•°æ®

```yaml
# âœ“ æ­£ç¡®
- name: classify
  tool: python
  script: |
    import openai

    emails = """{{emails}}"""

    response = openai.chat.completions.create(
      model="gpt-4",
      messages=[{"role": "user", "content": f"åˆ†ç±»è¿™äº›é‚®ä»¶ï¼š{emails}"}]
    )

    print(response.choices[0].message.content)

# âœ— ä¸æ¨è
- name: classify
  tool: shell
  args: ["./classify-emails.sh", "{{emails}}"]  # éœ€è¦é¢„å…ˆç¼–å†™å¤æ‚è„šæœ¬
```

### 3. ç”¨ç¡¬ç¼–ç å·¥å…·æ‰§è¡Œç²¾ç¡®æ“ä½œ

```yaml
# âœ“ æ­£ç¡®
- name: move-files
  tool: shell
  args: ["mv", "{{source}}", "{{dest}}"]

# âœ— ä¸æ¨è
- name: move-files
  tool: python
  script: |
    # AIä¸èƒ½ç›´æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œéœ€è¦è°ƒç”¨shellå‘½ä»¤
    import subprocess
    subprocess.run(["mv", "{{source}}", "{{dest}}"])
```

### 4. ç”¨AIç”Ÿæˆå†…å®¹

```yaml
# âœ“ æ­£ç¡®
- name: write-report
  tool: python
  script: |
    import openai

    data = """{{data}}"""

    response = openai.chat.completions.create(
      model="gpt-4",
      messages=[{"role": "user", "content": f"æ ¹æ®ä»¥ä¸‹æ•°æ®ç”ŸæˆæŠ¥å‘Šï¼š{data}"}]
    )

    print(response.choices[0].message.content)

# âœ— ä¸æ¨è
- name: write-report
  tool: shell
  args: ["./generate-report.sh", "{{data}}"]  # æ¨¡æ¿åŒ–ï¼Œç¼ºä¹çµæ´»æ€§
```

## æ··åˆæ¨¡å¼çš„è¾¹ç•Œ

| åœºæ™¯ | æ¨èå·¥å…· |
|-----|---------|
| è¯»å–æ–‡ä»¶ | ç¡¬ç¼–ç  |
| å†™å…¥æ–‡ä»¶ | ç¡¬ç¼–ç  |
| APIè°ƒç”¨ | ç¡¬ç¼–ç  |
| æ•°æ®è§£æ | ç¡¬ç¼–ç ï¼ˆç»“æ„åŒ–ï¼‰/ AIï¼ˆéç»“æ„åŒ–ï¼‰ |
| è¯­ä¹‰ç†è§£ | AI |
| å†…å®¹ç”Ÿæˆ | AI |
| åˆ†ç±»å†³ç­– | AI |
| ç²¾ç¡®æ“ä½œ | ç¡¬ç¼–ç  |

---

**æœ¬èŠ‚å°ç»“**

- ç¡¬ç¼–ç å·¥å…·ï¼šç¡®å®šæ€§ã€å¿«é€Ÿã€å¯é 
- AIæ¨ç†ï¼šçµæ´»ã€æ™ºèƒ½ã€åˆ›é€ æ€§
- æ··åˆæ¨¡å¼å‘æŒ¥å„è‡ªä¼˜åŠ¿
- ç¡¬ç¼–ç åšæ•°æ®è·å–å’Œç²¾ç¡®æ“ä½œ
- AIåšè¯­ä¹‰ç†è§£å’Œå†…å®¹ç”Ÿæˆ
